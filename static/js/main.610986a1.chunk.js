(this["webpackJsonpdnd-llm-gm"]=this["webpackJsonpdnd-llm-gm"]||[]).push([[0],[,,,,,function(e,t,a){e.exports=a(27)},,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(4),s=a(3),i=a.n(s);a(14),a(15),a(16),a(17);var l=e=>{let{onMenuToggle:t}=e;return r.a.createElement("header",{className:"app-header"},r.a.createElement("div",{className:"header-left"},r.a.createElement("button",{className:"menu-toggle",onClick:t,"aria-label":"Toggle menu"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),r.a.createElement("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),r.a.createElement("line",{x1:"3",y1:"18",x2:"21",y2:"18"}))),r.a.createElement("h1",{className:"app-title"},"D&D LLM Game Master")),r.a.createElement("div",{className:"header-right"},r.a.createElement("div",{className:"connection-status"},r.a.createElement("div",{className:"status-indicator connected"}),r.a.createElement("span",null,"Connected")),r.a.createElement("button",{className:"settings-button"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("circle",{cx:"12",cy:"12",r:"3"}),r.a.createElement("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"}))),r.a.createElement("button",{className:"help-button"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.a.createElement("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),r.a.createElement("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})))))};a(18);var c=e=>{let{isOpen:t,activeTab:a,onTabChange:n}=e;const o=[{id:"game-master",label:"Game Master",icon:r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("path",{d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"}))},{id:"character",label:"Character",icon:r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r.a.createElement("circle",{cx:"12",cy:"7",r:"4"}))},{id:"memory",label:"Memory",icon:r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.a.createElement("polyline",{points:"14 2 14 8 20 8"}),r.a.createElement("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.a.createElement("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),r.a.createElement("polyline",{points:"10 9 9 9 8 9"}))},{id:"combat",label:"Combat",icon:r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),r.a.createElement("polyline",{points:"14 2 14 8 20 8"}),r.a.createElement("path",{d:"M12 18v-6"}),r.a.createElement("path",{d:"M8 18v-1"}),r.a.createElement("path",{d:"M16 18v-3"}))},{id:"world",label:"World",icon:r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.a.createElement("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),r.a.createElement("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"}))}];return r.a.createElement("aside",{className:"sidebar "+(t?"open":"closed")},r.a.createElement("nav",{className:"sidebar-nav"},r.a.createElement("ul",null,o.map(e=>r.a.createElement("li",{key:e.id},r.a.createElement("button",{className:"nav-item "+(a===e.id?"active":""),onClick:()=>n(e.id),"aria-label":e.label,title:e.label},r.a.createElement("span",{className:"nav-icon"},e.icon),r.a.createElement("span",{className:"nav-label"},e.label)))))),r.a.createElement("div",{className:"sidebar-footer"},r.a.createElement("button",{className:"new-game-button"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.a.createElement("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),r.a.createElement("line",{x1:"8",y1:"12",x2:"16",y2:"12"})),r.a.createElement("span",null,"New Game")),r.a.createElement("button",{className:"save-game-button"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),r.a.createElement("polyline",{points:"17 21 17 13 7 13 7 21"}),r.a.createElement("polyline",{points:"7 3 7 8 15 8"})),r.a.createElement("span",null,"Save Game"))))};a(19);var m=()=>r.a.createElement("footer",{className:"app-footer"},r.a.createElement("p",{className:"footer-text"},"D&D LLM Game Master \xa9 ",(new Date).getFullYear()),r.a.createElement("div",{className:"footer-links"},r.a.createElement("a",{href:"#",className:"footer-link"},"Privacy"),r.a.createElement("a",{href:"#",className:"footer-link"},"Terms"),r.a.createElement("a",{href:"#",className:"footer-link"},"Help")));var d=e=>{let{children:t,activeTab:a,onTabChange:o}=e;const[s,i]=Object(n.useState)(!0);return r.a.createElement("div",{className:"main-layout "+(s?"sidebar-open":"sidebar-closed")},r.a.createElement(l,{onMenuToggle:()=>{i(!s)}}),r.a.createElement("div",{className:"main-content"},r.a.createElement(c,{isOpen:s,activeTab:a,onTabChange:o}),r.a.createElement("div",{className:"content-area"},t)),r.a.createElement(m,null))};a(20);const u=Object(n.createContext)(),h=["Welcome, adventurer! You find yourself at the entrance of a dark cave. What would you like to do?","As you step into the cave, the air grows cold. You see faint glimmers of light reflecting off what appears to be crystals embedded in the walls.","You hear a rustling sound from deeper within the cave. Something seems to be moving in the darkness ahead.","You discover an old wooden chest tucked away in a corner. It appears to be locked.","Rolling a perception check... You notice footprints in the dust. They seem to lead deeper into the cave."],p=e=>{let{children:t}=e;const[a,o]=Object(n.useState)(!0),[s,i]=Object(n.useState)(0),l={isConnected:a,generateResponse:async(e,t)=>{await new Promise(e=>setTimeout(e,1500));const a={text:h[s%h.length],gameStateChanges:null};return i(e=>e+1),a},toggleConnection:()=>{o(e=>!e)}};return r.a.createElement(u.Provider,{value:l},t)};var v=u;var g=()=>{const e=Object(n.useContext)(v);if(!e)throw new Error("useLLM must be used within an LLMContextProvider");return e};const E=Object(n.createContext)(),y={location:{name:"Cave Entrance",description:"A dark cave mouth looms before you, a chill wind emanating from its depths."},npcs:[{id:"npc-1",name:"Old Hermit",description:"A weathered old man with a long gray beard.",disposition:"Friendly",location:"Cave Entrance"}],quests:[{id:"quest-1",name:"The Crystal Cavern",description:"Explore the cave and discover its secrets.",status:"Active",objectives:[{id:"obj-1",description:"Enter the cave",completed:!1},{id:"obj-2",description:"Find the source of the crystals",completed:!1}]}],inventory:[],combatActive:!1,combatants:[]},w=e=>{let{children:t}=e;const[a,o]=Object(n.useState)(y),s={gameState:a,updateGameState:e=>{o(t=>({...t,...e}))},resetGameState:()=>{o(y)},completeObjective:(e,t)=>{o(a=>{const n=a.quests.map(a=>{if(a.id===e){const e=a.objectives.map(e=>e.id===t?{...e,completed:!0}:e);return{...a,objectives:e}}return a});return{...a,quests:n}})},addToInventory:e=>{o(t=>({...t,inventory:[...t.inventory,e]}))}};return r.a.createElement(E.Provider,{value:s},t)};var b=E;var f=()=>{const e=Object(n.useContext)(b);if(!e)throw new Error("useGameState must be used within a GameContextProvider");return e};var N=()=>{const[e,t]=Object(n.useState)([{id:"m1",type:"location",content:"The adventure began at the entrance to a mysterious cave system known for its glowing crystals.",timestamp:new Date(Date.now()-12e5).toISOString(),importance:"high"},{id:"m2",type:"npc",content:"Met an old hermit named Gareth who warned about strange noises coming from deep within the cave.",timestamp:new Date(Date.now()-9e5).toISOString(),importance:"medium"},{id:"m3",type:"item",content:"Found a rusty key that might open something important.",timestamp:new Date(Date.now()-6e5).toISOString(),importance:"low"},{id:"m4",type:"quest",content:"Accepted a quest to discover the source of the glowing crystals and their magical properties.",timestamp:new Date(Date.now()-3e5).toISOString(),importance:"high"}]),a=Object(n.useCallback)(e=>{const{userMessage:a,gmResponse:n,gameStateChanges:r}=e,o=`Player: "${a.slice(0,50)}${a.length>50?"...":""}" - GM: "${n.slice(0,50)}${n.length>50?"...":""}"`,s=r?"high":"medium",i={id:"m"+Date.now(),type:"conversation",content:o,timestamp:(new Date).toISOString(),importance:s,details:{userMessage:a,gmResponse:n,gameStateChanges:r}};return t(e=>[i,...e]),i},[]),r=Object(n.useCallback)(t=>{const a=t.toLowerCase(),n=e.filter(e=>e.content.toLowerCase().includes(a)).sort((e,t)=>{const a={high:3,medium:2,low:1},n=a[t.importance]-a[e.importance];return 0!==n?n:new Date(t.timestamp)-new Date(e.timestamp)}).slice(0,5);return Promise.resolve(n)},[e]),o=Object(n.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e))},[]),s=Object(n.useCallback)((e,a)=>{t(t=>t.map(t=>t.id===e?{...t,...a}:t))},[]);return{memories:e,addToMemory:a,retrieveRelevantMemories:r,deleteMemory:o,updateMemory:s}};a(21);var k=e=>{let{onRetry:t,onEdit:a,isGenerating:n}=e;return r.a.createElement("div",{className:"response-controls"},r.a.createElement("button",{className:"control-button retry",onClick:t,disabled:n,title:"Regenerate the last response"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("path",{d:"M1 4v6h6"}),r.a.createElement("path",{d:"M3.51 15a9 9 0 1 0 2.13-9.36L1 10"})),r.a.createElement("span",null,"Retry")),r.a.createElement("button",{className:"control-button edit",onClick:a,disabled:n,title:"Edit the last response"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"18",height:"18",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})),r.a.createElement("span",null,"Edit")),r.a.createElement("div",{className:"control-info"},r.a.createElement("span",{className:"info-text"},"These controls affect the Game Master's last response.")))},x=a(1);a(22);const S=new x.marked.Renderer;x.marked.setOptions({renderer:S,gfm:!0,breaks:!0,sanitize:!1,smartLists:!0,smartypants:!0,xhtml:!1});var C=e=>{let{content:t}=e,a=t;const n={};let o=0;a=a.replace(/```([\s\S]*?)```/g,e=>{const t="CODE_BLOCK_"+o;return n[t]=e,o++,t}),a=a.replace(/\b(\d+d\d+(?:[+-]\d+)?)\b/g,'<span class="dice-notation">$1</span>'),a=(e=>e.replace(/\b(HP|AC|STR|DEX|CON|INT|WIS|CHA)\b/g,'<span class="game-term">$1</span>').replace(/\b(attack roll|saving throw|ability check)\b/gi,'<span class="game-mechanic">$1</span>'))(a),Object.keys(n).forEach(e=>{a=a.replace(e,n[e])});const s=Object(x.marked)(a);return r.a.createElement("div",{className:"narrative-display",dangerouslySetInnerHTML:{__html:s}})};a(23);const M=[4,6,8,10,12,20,100];var O=()=>{const[e,t]=Object(n.useState)(!1),[a,o]=Object(n.useState)([]),[s,i]=Object(n.useState)(""),[l,c]=Object(n.useState)(1);return r.a.createElement("div",{className:"dice-roller "+(e?"open":"")},r.a.createElement("button",{className:"dice-roller-toggle",onClick:()=>{t(!e)},title:"Dice Roller"},r.a.createElement("span",{role:"img","aria-label":"Dice"},"\ud83c\udfb2")),e&&r.a.createElement("div",{className:"dice-roller-panel"},r.a.createElement("h3",null,"Dice Roller"),r.a.createElement("div",{className:"common-dice"},M.map(e=>r.a.createElement("button",{key:e,className:"dice-button",onClick:()=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const a=[];let n=0;for(let r=0;r<t;r++){const t=Math.floor(Math.random()*e)+1;a.push(t),n+=t}o(r=>[{id:Date.now(),dice:`${t}d${e}`,values:a,total:n},...r.slice(0,9)])}(e,l)},"d"+e))),r.a.createElement("div",{className:"dice-quantity"},r.a.createElement("label",{htmlFor:"dice-quantity"},"Quantity:"),r.a.createElement("input",{id:"dice-quantity",type:"number",min:"1",max:"100",value:l,onChange:e=>c(parseInt(e.target.value)||1)})),r.a.createElement("form",{className:"custom-dice-form",onSubmit:e=>{e.preventDefault();const t=s.match(/^(\d+)?d(\d+)([+-]\d+)?$/i);if(t){const e=t[1]?parseInt(t[1]):1,a=parseInt(t[2]),n=t[3]?parseInt(t[3]):0,r=[];let l=n;for(let t=0;t<e;t++){const e=Math.floor(Math.random()*a)+1;r.push(e),l+=e}o(e=>[{id:Date.now(),dice:s,values:r,total:l,modifier:n},...e.slice(0,9)]),i("")}}},r.a.createElement("input",{type:"text",placeholder:"e.g., 2d6+3",value:s,onChange:e=>i(e.target.value)}),r.a.createElement("button",{type:"submit"},"Roll")),r.a.createElement("div",{className:"dice-history"},r.a.createElement("h4",null,"Roll History"),a.length>0?r.a.createElement("ul",null,a.map(e=>r.a.createElement("li",{key:e.id},r.a.createElement("strong",null,e.dice,":")," ",e.values.join(", "),e.modifier?` ${e.modifier>0?"+":""}${e.modifier}`:""," = ",r.a.createElement("span",{className:"roll-total"},e.total)))):r.a.createElement("p",{className:"no-rolls"},"No dice rolled yet."))))};a(24);var j=e=>{let{text:t="Loading..."}=e;return r.a.createElement("div",{className:"loading-container"},r.a.createElement("div",{className:"loading-dots"},r.a.createElement("div",{className:"dot dot1"}),r.a.createElement("div",{className:"dot dot2"}),r.a.createElement("div",{className:"dot dot3"})),r.a.createElement("div",{className:"loading-text"},t))};var L=()=>{const[e,t]=Object(n.useState)(""),[a,o]=Object(n.useState)([]),[s,i]=Object(n.useState)(!1),[l,c]=Object(n.useState)(!1),[m,d]=Object(n.useState)(""),u=Object(n.useRef)(null),h=Object(n.useRef)(null),{generateResponse:p,isConnected:v}=g(),{gameState:E,updateGameState:y}=f(),{addToMemory:w,retrieveRelevantMemories:b}=N();Object(n.useEffect)(()=>{u.current&&u.current.scrollIntoView({behavior:"smooth"})},[a]),Object(n.useEffect)(()=>{h.current&&h.current.focus()},[]);const x=async()=>{if(!e.trim()||s)return;const n={role:"user",content:e,timestamp:(new Date).toISOString()};o(e=>[...e,n]),t(""),i(!0);try{const t=await b(e),n=await p(e,{gameState:E,memories:t,conversation:a}),r={role:"assistant",content:n.text,timestamp:(new Date).toISOString(),gameStateChanges:n.gameStateChanges||null};o(e=>[...e,r]),n.gameStateChanges&&y(n.gameStateChanges),w({userMessage:e,gmResponse:n.text,gameStateChanges:n.gameStateChanges})}catch(r){console.error("Error generating response:",r),o(e=>[...e,{role:"system",content:"Sorry, there was an error communicating with the Game Master. Please try again.",timestamp:(new Date).toISOString(),isError:!0}])}finally{i(!1)}};return r.a.createElement("div",{className:"game-master-panel"},r.a.createElement("div",{className:"game-master-header"},r.a.createElement("h2",null,"Game Master"),r.a.createElement(O,null)),r.a.createElement("div",{className:"conversation-container"},0===a.length?r.a.createElement("div",{className:"empty-conversation"},r.a.createElement("p",null,"Your adventure awaits! Talk to the Game Master to begin...")):a.map((e,t)=>r.a.createElement("div",{key:t,className:`message ${e.role} ${e.isError?"error":""}`},r.a.createElement("div",{className:"message-avatar"},"user"===e.role?"\ud83e\uddd9\u200d\u2642\ufe0f":"assistant"===e.role?"\ud83d\udcdc":"\u26a0\ufe0f"),r.a.createElement("div",{className:"message-content"},r.a.createElement(C,{content:e.content}),e.isEdited&&r.a.createElement("span",{className:"edited-tag"},"(edited)")))),s&&r.a.createElement("div",{className:"message assistant generating"},r.a.createElement("div",{className:"message-avatar"},"\ud83d\udcdc"),r.a.createElement("div",{className:"message-content"},r.a.createElement(j,{text:"The Game Master is thinking..."}))),r.a.createElement("div",{ref:u})),l?r.a.createElement("div",{className:"response-edit-container"},r.a.createElement("textarea",{value:m,onChange:e=>d(e.target.value),placeholder:"Edit the Game Master's response...",rows:4}),r.a.createElement("div",{className:"edit-buttons"},r.a.createElement("button",{onClick:()=>{c(!1),d("")}},"Cancel"),r.a.createElement("button",{onClick:()=>{if(!m.trim())return;const e=[...a],t=e.map(e=>e.role).lastIndexOf("assistant");-1!==t&&(e[t]={...e[t],content:m,isEdited:!0},o(e),c(!1),d(""))}},"Save"))):r.a.createElement(r.a.Fragment,null,r.a.createElement(k,{onRetry:async()=>{if(a.length<1)return;const e=[...a],t=e.map(e=>e.role).lastIndexOf("user");if(-1!==t){const a=e[t];o(e.slice(0,t+1)),i(!0);try{const n=await b(a.content),r=await p(a.content,{gameState:E,memories:n,conversation:e.slice(0,t)}),s={role:"assistant",content:r.text,timestamp:(new Date).toISOString(),gameStateChanges:r.gameStateChanges||null};o(e=>[...e,s]),r.gameStateChanges&&y(r.gameStateChanges),w({userMessage:a.content,gmResponse:r.text,gameStateChanges:r.gameStateChanges})}catch(n){console.error("Error regenerating response:",n),o(e=>[...e,{role:"system",content:"Sorry, there was an error communicating with the Game Master. Please try again.",timestamp:(new Date).toISOString(),isError:!0}])}finally{i(!1)}}},onEdit:()=>{if(a.length<1)return;const e=[...a].reverse().find(e=>"assistant"===e.role);e&&(d(e.content),c(!0))},isGenerating:s}),r.a.createElement("div",{className:"input-container"},r.a.createElement("textarea",{ref:h,value:e,onChange:e=>{t(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),x())},placeholder:"Tell the Game Master what you want to do...",rows:2,disabled:s||!v}),r.a.createElement("button",{onClick:x,disabled:!e.trim()||s||!v},"Send")),!v&&r.a.createElement("div",{className:"connection-warning"},"Not connected to LLM service. Check your connection settings.")))};const D=Object(n.createContext)(),T={name:"Tharion Nightblade",race:"Half-Elf",class:"Rogue",level:3,alignment:"Chaotic Good",background:"Criminal",abilityScores:{strength:12,dexterity:16,constitution:14,intelligence:14,wisdom:10,charisma:14},combatStats:{hitPoints:{max:24,current:24,temporary:0},armorClass:15,initiative:3,speed:30,hitDice:{total:3,used:0,type:"d8"}},skills:{acrobatics:{proficient:!0,expertise:!1},animalHandling:{proficient:!1,expertise:!1},arcana:{proficient:!1,expertise:!1},athletics:{proficient:!1,expertise:!1},deception:{proficient:!0,expertise:!0},history:{proficient:!1,expertise:!1},insight:{proficient:!1,expertise:!1},intimidation:{proficient:!1,expertise:!1},investigation:{proficient:!0,expertise:!1},medicine:{proficient:!1,expertise:!1},nature:{proficient:!1,expertise:!1},perception:{proficient:!0,expertise:!1},performance:{proficient:!1,expertise:!1},persuasion:{proficient:!0,expertise:!1},religion:{proficient:!1,expertise:!1},sleightOfHand:{proficient:!0,expertise:!0},stealth:{proficient:!0,expertise:!0},survival:{proficient:!1,expertise:!1}},inventory:[{id:"item-1",name:"Shortsword",type:"Weapon",quantity:1,weight:2,description:"Finesse, light"},{id:"item-2",name:"Dagger",type:"Weapon",quantity:2,weight:1,description:"Finesse, light, thrown (range 20/60)"},{id:"item-3",name:"Thieves' Tools",type:"Tool",quantity:1,weight:1,description:"Proficiency allows you to add your proficiency bonus to any ability checks made to disarm traps or open locks."},{id:"item-4",name:"Potion of Healing",type:"Potion",quantity:3,weight:.5,description:"Regains 2d4+2 hit points when consumed."}],spells:[],features:[{name:"Sneak Attack",description:"Once per turn, you can deal an extra 2d6 damage to one creature you hit with an attack if you have advantage on the attack roll."},{name:"Cunning Action",description:"You can use a bonus action to take the Dash, Disengage, or Hide action."},{name:"Thieves' Cant",description:"You know the secret language of thieves."}],proficiencies:{languages:["Common","Elvish","Thieves' Cant"],weapons:["Simple weapons","Hand crossbows","Longswords","Rapiers","Shortswords"],armor:["Light armor"],tools:["Thieves' tools","Playing cards"]}},I=e=>{let{children:t}=e;const[a,o]=Object(n.useState)(T),s={character:a,updateCharacter:e=>{o(t=>({...t,...e}))},updateAbilityScore:(e,t)=>{o(a=>({...a,abilityScores:{...a.abilityScores,[e]:t}}))},updateHitPoints:(e,t,a)=>{o(n=>({...n,combatStats:{...n.combatStats,hitPoints:{current:void 0!==e?e:n.combatStats.hitPoints.current,max:void 0!==t?t:n.combatStats.hitPoints.max,temporary:void 0!==a?a:n.combatStats.hitPoints.temporary}}}))},addInventoryItem:e=>{const t=a.inventory.findIndex(t=>t.name.toLowerCase()===e.name.toLowerCase()&&t.type===e.type);if(t>=0){const n=[...a.inventory];n[t]={...n[t],quantity:n[t].quantity+(e.quantity||1)},o(e=>({...e,inventory:n}))}else o(t=>({...t,inventory:[...t.inventory,{id:"item-"+Date.now(),...e}]}))},removeInventoryItem:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=a.inventory.findIndex(t=>t.id===e);if(n>=0){if(a.inventory[n].quantity<=t)o(t=>({...t,inventory:t.inventory.filter(t=>t.id!==e)}));else{const e=[...a.inventory];e[n]={...e[n],quantity:e[n].quantity-t},o(t=>({...t,inventory:e}))}}}};return r.a.createElement(D.Provider,{value:s},t)};var P=D;var W=()=>{const e=Object(n.useContext)(P);if(!e)throw new Error("useCharacter must be used within a CharacterContextProvider");return e};a(25);var A=()=>{const{character:e}=W();return r.a.createElement("div",{className:"character-sheet"},r.a.createElement("div",{className:"character-header"},r.a.createElement("h2",null,"Character Sheet")),r.a.createElement("div",{className:"character-content"},r.a.createElement("div",{className:"character-basic-info"},r.a.createElement("h3",null,e.name),r.a.createElement("div",{className:"character-details"},r.a.createElement("span",null,"Level ",e.level," ",e.race," ",e.class),r.a.createElement("span",null,e.alignment),r.a.createElement("span",null,"Background: ",e.background))),r.a.createElement("div",{className:"character-stats"},r.a.createElement("h3",null,"Ability Scores"),r.a.createElement("div",{className:"ability-scores"},Object.entries(e.abilityScores).map(e=>{let[t,a]=e;return r.a.createElement("div",{key:t,className:"ability-score"},r.a.createElement("div",{className:"ability-label"},t.charAt(0).toUpperCase()+t.slice(1)),r.a.createElement("div",{className:"ability-value"},a),r.a.createElement("div",{className:"ability-modifier"},Math.floor((a-10)/2)))}))),r.a.createElement("div",{className:"character-combat"},r.a.createElement("h3",null,"Combat Stats"),r.a.createElement("div",{className:"combat-stats"},r.a.createElement("div",{className:"combat-stat"},r.a.createElement("div",{className:"stat-label"},"Hit Points"),r.a.createElement("div",{className:"stat-value"},e.combatStats.hitPoints.current," / ",e.combatStats.hitPoints.max)),r.a.createElement("div",{className:"combat-stat"},r.a.createElement("div",{className:"stat-label"},"Armor Class"),r.a.createElement("div",{className:"stat-value"},e.combatStats.armorClass)),r.a.createElement("div",{className:"combat-stat"},r.a.createElement("div",{className:"stat-label"},"Initiative"),r.a.createElement("div",{className:"stat-value"},"+",e.combatStats.initiative)),r.a.createElement("div",{className:"combat-stat"},r.a.createElement("div",{className:"stat-label"},"Speed"),r.a.createElement("div",{className:"stat-value"},e.combatStats.speed," ft")))),r.a.createElement("div",{className:"character-features"},r.a.createElement("h3",null,"Features & Traits"),r.a.createElement("ul",{className:"features-list"},e.features.map((e,t)=>r.a.createElement("li",{key:t,className:"feature-item"},r.a.createElement("h4",null,e.name),r.a.createElement("p",null,e.description))))),r.a.createElement("div",{className:"character-inventory"},r.a.createElement("h3",null,"Inventory"),r.a.createElement("table",{className:"inventory-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Item"),r.a.createElement("th",null,"Qty"),r.a.createElement("th",null,"Weight"),r.a.createElement("th",null,"Description"))),r.a.createElement("tbody",null,e.inventory.map(e=>r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.quantity),r.a.createElement("td",null,e.weight*e.quantity," lb"),r.a.createElement("td",null,e.description))))))))};a(26);var R=()=>{const{memories:e,deleteMemory:t,updateMemory:a}=N(),[o,s]=Object(n.useState)(""),[i,l]=Object(n.useState)("all"),c=e.filter(e=>{const t=e.content.toLowerCase().includes(o.toLowerCase()),a="all"===i||e.type===i;return t&&a});return r.a.createElement("div",{className:"memory-panel"},r.a.createElement("div",{className:"memory-header"},r.a.createElement("h2",null,"Adventure Memory"),r.a.createElement("p",null,"Your adventure journal maintains important information for continuity.")),r.a.createElement("div",{className:"memory-controls"},r.a.createElement("div",{className:"search-box"},r.a.createElement("input",{type:"text",placeholder:"Search memories...",value:o,onChange:e=>s(e.target.value)})),r.a.createElement("div",{className:"memory-filters"},r.a.createElement("select",{value:i,onChange:e=>l(e.target.value)},r.a.createElement("option",{value:"all"},"All Types"),r.a.createElement("option",{value:"location"},"Locations"),r.a.createElement("option",{value:"npc"},"NPCs"),r.a.createElement("option",{value:"item"},"Items"),r.a.createElement("option",{value:"quest"},"Quests"),r.a.createElement("option",{value:"conversation"},"Conversations")))),r.a.createElement("div",{className:"memories-list"},c.length>0?c.map(e=>{return r.a.createElement("div",{key:e.id,className:"memory-item importance-"+e.importance},r.a.createElement("div",{className:"memory-icon"},(e=>{switch(e){case"location":return"\ud83d\uddfa\ufe0f";case"npc":return"\ud83d\udc64";case"item":return"\ud83d\udd2e";case"quest":return"\ud83d\udcdc";case"conversation":return"\ud83d\udcac";default:return"\ud83d\udcdd"}})(e.type)),r.a.createElement("div",{className:"memory-content"},r.a.createElement("div",{className:"memory-text"},e.content),r.a.createElement("div",{className:"memory-meta"},r.a.createElement("span",{className:"memory-type"},e.type),r.a.createElement("span",{className:"memory-time"},(n=e.timestamp,new Date(n).toLocaleString())))),r.a.createElement("div",{className:"memory-actions"},r.a.createElement("button",{className:"edit-memory",title:"Edit memory",onClick:()=>{const t=prompt("Edit memory:",e.content);t&&t!==e.content&&a(e.id,{content:t})}},"\u270f\ufe0f"),r.a.createElement("button",{className:"delete-memory",title:"Delete memory",onClick:()=>{window.confirm("Are you sure you want to delete this memory?")&&t(e.id)}},"\ud83d\uddd1\ufe0f")));var n}):r.a.createElement("div",{className:"no-memories"},r.a.createElement("p",null,"No memories match your search."))))};var G=function(){const[e,t]=Object(n.useState)("game-master");return r.a.createElement("div",{className:"app"},r.a.createElement(p,null,r.a.createElement(w,null,r.a.createElement(I,null,r.a.createElement(d,{activeTab:e,onTabChange:t},(()=>{switch(e){case"game-master":return r.a.createElement(L,null);case"character":return r.a.createElement(A,null);case"memory":return r.a.createElement(R,null);default:return r.a.createElement(L,null)}})())))))};const q=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function H(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}i.a.createRoot(document.getElementById("root")).render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,null,r.a.createElement(G,null)))),function(e){if("serviceWorker"in navigator){if(new URL("/AI-GM-Adventure",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="/AI-GM-Adventure/service-worker.js";q?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then(a=>{const n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):H(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")})):H(t,e)})}}()}],[[5,1,2]]]);
//# sourceMappingURL=main.610986a1.chunk.js.map